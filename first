# Use audio loader explicitly for loading audio waveform :
import pathlib
from spleeter.separator import Separator
from spleeter.audio.adapter import get_default_audio_adapter
separator = Separator('spleeter:2stems')
audio_adapter = get_default_audio_adapter()

sample_rate = 44100
waveform, _ = audio_loader.load('/content/sample_data/hua.mp3', sample_rate=sample_rate)
separator.separate_to_file(
            '/content/sample_data/hua.mp3',
            '/content/sample_data/',
            audio_adapter=audio_adapter,
            synchronous=False)
            
from pydub import AudioSegment
from pydub.silence import split_on_silence
sound =  AudioSegment.from_file("/content/sample_data/hua/vocals.wav", format="wav")
chunks = split_on_silence(sound, 
    # must be silent for at least half a second
    min_silence_len=3000,

    # consider it silent if quieter than -30 dBFS
    silence_thresh=-37,
    keep_silence=False,
    seek_step=5
)
for i, chunk in enumerate(chunks):
    chunk.export("/content/sample_data/hua/chunk{0}.mp3".format(i), format="mp3")
    
from pydub import AudioSegment
sound1 = AudioSegment.from_mp3('/content/sample_data/hua/chunk1.mp3')
sound2 = AudioSegment.from_mp3('/content/sample_data/hua/chunk2.mp3')
#sound3 = AudioSegment.from_mp3('/content/sample_data/hua/chunk3.mp3')
hua=sound1+sound2 #+sound3
hua.export("/content/sample_data/hua/hua.mp3", format="mp3")
